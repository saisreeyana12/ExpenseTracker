<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./tracker.css">
</head>

<body>
    <div class="header">
        <p class="m-0">Expense <br> Tracker
            <img src="./spending.png" alt="" width="35px" height="35px">
        </p>
    </div>
    <div class="input-form">
        <div class="form-floating inputs">
            <input type="email" class="form-control Amountinput" id="floatingInput" placeholder="name@example.com">
            <label for="floatingInput">Amount</label>
        </div>
        <select class="form-select inputs Transactiontype" aria-label="Default select example">
            <option selected>Transaction Type</option>
            <option value="Income">Income</option>
            <option value="Expense">Expense</option>
        </select>
        <div class="form-floating inputs">
            <input type="date" class="form-control Dateinput" id="floatingInput" placeholder="name@example.com">
            <label for="floatingInput">Date</label>
        </div>
        <button class="btn" id="add-button" onclick="addRow()">+</button>
    </div>

    <div class="cards mt-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title m-0">Total Income
                    <img src="./wallet-filled-money-tool.png" alt="" width="30px">
                </h5>
                <h1 class="m-0">
                    <img src="./rupee.png" alt="" width="30px">
                    <span id="totalIncome">0</span>
                </h1>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h5 class="card-title m-0">Total Expense
                    <img src="./wallet_78921.png" alt="" width="30px">
                </h5>
                <h1 class="m-0">
                    <img src="./rupee.png" alt="" width="30px">
                    <span id="totalExpense">0</span>
                </h1>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h5 class="card-title m-0">Balance
                    <img src="./icons8-money-bag-rupee-50.png" alt="" width="30px">
                </h5>
                <h1 class="m-0">
                    <img src="./rupee.png" alt="" width="30px">
                    <span id="Balance">0</span>
                </h1>
            </div>
        </div>
    </div>
    <table class="transaction-table mt-3" id="table">
        <tr id="header-row">
            <th>Amount</th>
            <th>Transaction Type</th>
            <th>Transaction Date</th>
            <th>Action</th>
        </tr>



    </table>
    <script>
        let table = document.getElementById('table')
        console.log("Table", table)
        function deleteRow(row) {
            let amount = parseInt(row.children[0].innerText);
            let transactionType = row.children[1].innerText;

            let totalIncomeEl = document.getElementById('totalIncome');
            let totalExpenseEl = document.getElementById('totalExpense');
            let balanceEl = document.getElementById('Balance');

            let totalIncome = parseInt(totalIncomeEl.innerText);
            let totalExpense = parseInt(totalExpenseEl.innerText);
            let balance = parseInt(balanceEl.innerText);

            if (transactionType === 'Income') {
                totalIncomeEl.innerText = totalIncome - amount;
                balanceEl.innerText = balance - amount;
            }
            else if (transactionType === 'Expense') {
                totalExpenseEl.innerText = totalExpense - amount;
                balanceEl.innerText = balance + amount;
            }

            row.remove();
        }


        function addRow() {
            let date = document.getElementsByClassName('Dateinput')[0].value
            let amount = document.getElementsByClassName('Amountinput')[0].value
            let transactiontype = document.getElementsByClassName('Transactiontype')[0].value


            if (date != '' && amount != '' && transactiontype != 'Transaction Type') {
                let row = document.createElement('tr')

                let amountcell = document.createElement('td')
                amountcell.innerText = amount;

                let transactioncell = document.createElement('td')
                transactioncell.innerText = transactiontype;

                let datecell = document.createElement('td')
                datecell.innerText = date;

                let bincell = document.createElement('td')
                let deletebutton = document.createElement('button')

                let binImage = document.createElement('img')
                binImage.src = "./recycle-bin.png"
                binImage.style.width = '30px'
                binImage.style.height = '30px'
                deletebutton.appendChild(binImage)
                deletebutton.classList.add('delete-button')
                deletebutton.onclick = () => deleteRow(row)

                bincell.appendChild(deletebutton);



                row.appendChild(amountcell)
                row.appendChild(transactioncell)
                row.appendChild(datecell)
                row.appendChild(bincell)

                table.appendChild(row)


                let totalIncome = document.getElementById('totalIncome').innerText
                let totalExpense = document.getElementById('totalExpense').innerText
                let Balance = document.getElementById('Balance').innerText

                if (transactiontype == 'Income') {
                    if (totalIncome == '0') {
                        document.getElementById('totalIncome').innerText = amount
                    }
                    else {
                        document.getElementById('totalIncome').innerText = parseInt(totalIncome) + parseInt(amount)
                    }
                    if (Balance == '0') {
                        document.getElementById('Balance').innerText = amount
                    }
                    else {
                        document.getElementById('Balance').innerText = parseInt(Balance) + parseInt(amount)
                    }
                }
                else if (transactiontype == 'Expense') {
                    if (totalExpense == '0') {
                        document.getElementById('totalExpense').innerText = amount
                    }
                    else {
                        document.getElementById('totalExpense').innerText = parseInt(totalExpense) + parseInt(amount)
                    }
                    if (Balance == '0') {
                        document.getElementById('Balance').innerText = -amount
                    }
                    else {
                        document.getElementById('Balance').innerText = parseInt(Balance) - parseInt(amount)
                    }
                }
            }
            else {
                alert("Must Enter all th fields")
            }

        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
        integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y"
        crossorigin="anonymous"></script>
</body>

</html>